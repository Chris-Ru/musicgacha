<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>...</title>
    <link rel="stylesheet" th:href="@{/css/main.css}">
    <link rel="stylesheet" th:href="@{/css/nav.css}">
</head>
<body onload="updateScore()">
<!-- Begin navigation fragments -->
<th:block xmlns:th="http://www.w3.org/1999/xhtml" th:fragment="header">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.9.4/dist/css/uikit.min.css"/>
    <!-- <link rel="stylesheet" th:href="@{/css/nav.css}"> -->

    <nav class="cnav navbar navbar-expand">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">MusicGacha</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown"
                    aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavDropdown">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/about">About Us</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/shop">Shop</a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link" href="https://zenxha.github.io/musicgacha/">GitHub Pages</a>
                    </li>
                   <!-- <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDarkDropdownMenuLink0" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Minilabs
                        </a>
                        <ul class="dropdown-menu dropdown-menu-dark" aria-labelledby="navbarDarkDropdownMenuLink">
                            <a class="dropdown-item" href="/about/komay">Komay</a>
                            <a class="dropdown-item" href="/about/allen">Allen</a>
                            <a class="dropdown-item" href="/about/tanmay">Tanmay</a>
                            <a class="dropdown-item" href="/about/roop">Roop</a>
                            <a class="dropdown-item" href="/about/nick">Nicholas</a>
                        </ul >
                    </li> -->
                </ul>
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item d-flex">
                        <form class="d-flex" action="https://youtube.com/results" method="get">
                            <input class="form-control me-2" name="search_query" type="search" placeholder="Search"
                                   aria-label="Search">
                            <button class="btn btn-outline-error" type="submit">Search</button>
                        </form>
                    </li>
                </ul>

            </div>
            <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Save Score?</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            Save your current score?

                            <div class="mb-3">
                                <label for="username" class="form-label"></label>
                                <div id="emailHelp" class="form-text">The username to save your score under</div>
                                <input type="text" class="form-control" id="username" aria-describedby="emailHelp">
                                <p>Your current score: </p>
                                <p id="currentscore"></p>

                            </div>
                            <!--                                    <button type="submit" class="btn btn-primary">Submit</button>-->

                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="pushScore()">Yes</button>
                        </div>
                    </div>
                </div>
            </div>
            <style>
                #scorelabel {
                    font-weight: bold;
                }

                #score {
                    color: #ff0000;
                    font-weight: bold;
                }
            </style>
            <script>
                // default color for switch
                document.body.style.backgroundColor = "#3494E6"

                console.log("yo")
                document.getElementById("scorelabel").textContent = "Social Credit Score: 0"
                document.getElementById("username").setAttribute('value', localStorage.getItem("username"));
                document.getElementById("currentscore").innerText = localStorage.getItem("score")
                function pushScore() {
                    let score = localStorage.getItem("score")

                    // let username = $('saveform').serializeArray()[0]
                    const username = document.getElementById('username').value;
                    localStorage.setItem("username", username)
                    console.log(username)
                    alert("Saved score of "+ score+" for "+username)
                    $.post('/api/pushscore',
                        {
                            username: username,
                            score: localStorage.getItem("score").toString()})
                }


                function updateScore() {
                    let score = localStorage.getItem("score");
                    document.getElementById("scorelabel").textContent = "Social Credit Score: " + score.toString();
                }

                setInterval(updateScore, 1000)
            </script>
        </div>
    </nav>
</th:block>

<!-- Begin navigation fragments -->
</body>
</html>